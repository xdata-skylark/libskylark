<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Building from Source &mdash; libSkylark  documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="libSkylark  documentation" href="index.html" />
    <link rel="next" title="Base Layer" href="base.html" />
    <link rel="prev" title="Quick Start Guide" href="quick_start.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>libSkylark  documentation</span></a></h1>
        <h2 class="heading"><span>Building from Source</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="quick_start.html">Quick Start Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="base.html">Base Layer</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="building-from-source">
<h1>Building from Source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-the-source-code">
<h2>Getting the source code<a class="headerlink" href="#getting-the-source-code" title="Permalink to this headline">¶</a></h2>
<p>The source code is hosted on github. The libSkylark git repository can be
cloned using the following command.</p>
<div class="highlight-sh"><div class="highlight"><pre>git clone https://github.com/xdata-skylark/libskylark.git
</pre></div>
</div>
</div>
<div class="section" id="libskylark-software-dependencies">
<h2>libSkylark Software Dependencies<a class="headerlink" href="#libskylark-software-dependencies" title="Permalink to this headline">¶</a></h2>
<p>libSkylark uses several open-source software packages that are essential for its
operation (build, install, and run). In this section, we give instructions to
install these software packages on Ubuntu machines. Installing the required
software packages on other operating systems should be very similar.</p>
<p>We can build libSkylark in one or more of four possible configurations:</p>
<blockquote>
<div><ul class="simple">
<li>libSkylark C++ bindings with support for dense (Elemental) matrices skylark-c++-dense</li>
<li>libSkylark C++ bindings with support for sparse (CombBLAS) matrices skylark-c++-sparse</li>
<li>libSkylark python and C++ bindings with support for dense (Elemental) matrices skylark-python-dense</li>
<li>libSkylark python and C++ bindings with support for sparse (CombBLAS) matrices skylark-python-sparse</li>
</ul>
</div></blockquote>
<p>Please refer to the graph of dependencies for realizing these configurations.
Note that nodes with version information within brackets refer to software
packages while nodes containing no brackets refer to libSkylark build targets.
The versions denote the ones that we have tested with, but apart from Elemental,
CombBLAS, and KDT versions, which need to be strictly followed, other software
(CMake, gfortran, etc) may work just as well with other versions as well.
Orange colored components denote C++ dependencies and the color green is used
for Python dependencies.</p>
<a class="reference internal image-reference" href="_images/skylark-dependencies.png"><img alt="_images/skylark-dependencies.png" class="align-center" src="_images/skylark-dependencies.png" style="width: 650px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On a fresh 64-bit Ubuntu-based (release 12.04 LTS, aka precise) you can
use the provided bootstrap script <code class="docutils literal"><span class="pre">vagrant/precise64/boostrap.sh</span></code> to
install libSkylark dependencies.</p>
</div>
<div class="section" id="python-setuptools">
<h3>python-setuptools<a class="headerlink" href="#python-setuptools" title="Permalink to this headline">¶</a></h3>
<p>To get easy_install and others.</p>
<p><em>Installation</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install python-setuptools
</pre></div>
</div>
</div>
<div class="section" id="g-4-7-1-for-elemental-support">
<h3>g++ (&gt;=4.7.1 for Elemental support)<a class="headerlink" href="#g-4-7-1-for-elemental-support" title="Permalink to this headline">¶</a></h3>
<p>The C++ compiler in the GNU Compiler Collection (GCC).</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install g++
</pre></div>
</div>
<p>In case your ubuntu repository does not contain a GCC/G++ version 4.7 use the following:</p>
<div class="highlight-rst"><div class="highlight"><pre>sudo add-apt-repository ppa:ubuntu-toolchain-r/test
sudo apt-get update
sudo apt-get install gcc-4.7 g++-4.7
</pre></div>
</div>
<p>and (optionally) use 4.7 as default compiler:</p>
<div class="highlight-rst"><div class="highlight"><pre>sudo update-alternatives --remove gcc /usr/bin/gcc-4.6
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.7 60 --slave /usr/bin/g++ g++ /usr/bin/g++-4.7
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.6 40 --slave /usr/bin/g++ g++ /usr/bin/g++-4.6
</pre></div>
</div>
</div>
<div class="section" id="gfortran-compiler">
<h3>gfortran compiler<a class="headerlink" href="#gfortran-compiler" title="Permalink to this headline">¶</a></h3>
<p>gfortran is the name of the  GNU  Fortran  compiler, which is part of the  GNU Compiler Collection (GCC).</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install gfortran
</pre></div>
</div>
</div>
<div class="section" id="cmake-2-8-8-for-elemental-support">
<h3>CMake (&gt;= 2.8.8 for Elemental support)<a class="headerlink" href="#cmake-2-8-8-for-elemental-support" title="Permalink to this headline">¶</a></h3>
<p>CMake is a cross-platform free software program managing the build process of
software using a compiler-independent method. It is designed to support
directory hierarchies and applications that depend on multiple libraries, and
for use in conjunction with native build environments such as make.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install cmake
</pre></div>
</div>
<p>If the available version is too old, compile CMake by hand.
Head to <a class="reference external" href="http://www.cmake.org/cmake/resources/software.html">http://www.cmake.org/cmake/resources/software.html</a> and download the
latest version.</p>
<div class="highlight-rst"><div class="highlight"><pre>./bootstrap --prefix=$CMAKE_INSTALL_DIR
make
make install
</pre></div>
</div>
<p>By specifying a <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">CMAKE_INSTALL_DIR</span></code> the install target for CMake can be
set. If no <code class="docutils literal"><span class="pre">--prefix</span></code> is set, CMake will be installed in <code class="file docutils literal"><span class="pre">/usr/local</span></code>.
Make sure to add the install path to your <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code> environment variable.</p>
</div>
<div class="section" id="blas-and-lapack">
<h3>BLAS and LAPACK<a class="headerlink" href="#blas-and-lapack" title="Permalink to this headline">¶</a></h3>
<p>Basic Linear Algebra Subroutine (BLAS) is a de facto application
programming interface standard for publishing libraries to perform basic
linear algebra operations such as vector and matrix multiplication.
LAPACK (Linear Algebra PACKage) is a software library for numerical linear
algebra. It provides routines systems of linear equations and linear least
squares, eigenvalue problems, and singular value decomposition. It also
includes routines to implement the associated QR, Cholesky and Schur
decomposition.</p>
<p>We provide instructions for using Ubuntu&#8217;s repository and using OpenBLAS.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install libblas-dev libblas-doc libblas3gf liblapack-dev liblapack-doc liblapack3gf
</pre></div>
</div>
<p>Experiments show good speedups with using OpenBLAS.</p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://github.com/xianyi/OpenBLAS/tarball/v0.2.8
</pre></div>
</div>
<p><em>Installation (to enable OpenMP support in OpenBLAS):</em></p>
<div class="highlight-rst"><div class="highlight"><pre>make USE_OPENMP=1 FC=gfortran; make install PREFIX=/path/to/install-directory
</pre></div>
</div>
</div>
<div class="section" id="mpich2">
<h3>MPICH2<a class="headerlink" href="#mpich2" title="Permalink to this headline">¶</a></h3>
<p>MPICH is a freely available, portable implementation of MPI, a standard for
message-passing for distributed-memory applications used in parallel
computing. MPICH is free software and is available for most flavors of
Unix-like OS (including Linux).</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install libcr-dev mpich2 mpich2-doc
</pre></div>
</div>
</div>
<div class="section" id="numpy-and-scipy">
<h3>NumPy and SciPy<a class="headerlink" href="#numpy-and-scipy" title="Permalink to this headline">¶</a></h3>
<p>NumPy is an extension to the Python programming language, adding support
for large, multi-dimensional arrays and matrices, along with a large
library of high-level mathematica functions to operate on these arrays.
SciPy is an open source library of algorithms and mathematical tools for
the Python programming language that grew out of Travis Oliphant&#8217;s original
collection of extension modules for Python which he released in 1999 under
the name Multipack (named for the netlib packages that it brought together
such as ODEPACK, QUADPACK, and MINPACK).</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install python-numpy python-scipy
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Elemental-0.86 requires a NumPy version &gt;= 1.7. On Ubuntu Precise the deb sources only contain version 1.6.x. To upgrade use either:</p>
<div class="highlight-rst"><div class="highlight"><pre>wget https://launchpad.net/~tukss/+archive/ppa/+build/4055943/+files/python-numpy_1.7.0~b2-1~precise1_amd64.deb
sudo dpkg -i python-numpy_1.7.0~b2-1~precise1_amd64.deb
</pre></div>
</div>
<p>or</p>
<div class="last highlight-rst"><div class="highlight"><pre>sudo easy_install -U scipy
</pre></div>
</div>
</div>
</div>
<div class="section" id="mpi4py">
<h3>mpi4py<a class="headerlink" href="#mpi4py" title="Permalink to this headline">¶</a></h3>
<p>MPI for Python (mpi4py) provides bindings of the Message Passing Interface
(MPI) standard for the Python programming language, allowing any Python
program to exploit multiple processors.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo easy_install mpi4py
</pre></div>
</div>
</div>
<div class="section" id="hdf5">
<h3>hdf5<a class="headerlink" href="#hdf5" title="Permalink to this headline">¶</a></h3>
<p>hdf5 is a portable data model, library and file format for storing and
managing data.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://www.hdfgroup.org/ftp/HDF5/current/src/hdf5-1.8.12.tar
tar -xvf hdf5-1.8.12.tar
cd hdf5-1.8.12
./configure --enable-cxx --prefix=&lt;location for HDF5 software&gt;
make &gt;&amp; make.out
make check &gt;&amp; check.out
make install
</pre></div>
</div>
</div>
<div class="section" id="h5py">
<h3>h5py<a class="headerlink" href="#h5py" title="Permalink to this headline">¶</a></h3>
<p>h5py (h5py) provides Python bindings to hdf5, which is a data model,
library, and file format for storing and managing data.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install libhdf5-serial-dev
sudo easy_install h5py
</pre></div>
</div>
</div>
<div class="section" id="boost-c-1-53-0">
<h3>Boost C++ 1.53.0<a class="headerlink" href="#boost-c-1-53-0" title="Permalink to this headline">¶</a></h3>
<p>Boost is a set of libraries for the C++ programming language that provide
support for tasks and structures such as linear algebra, pseudorandom
number generation, multithreading, image processing, regular expressions,
and unit testing.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://sourceforge.net/projects/boost/files/boost/1.53.0/boost_1_53_0.tar.gz
tar xvfz boost_1_53_0.tar.gz
cd boost_1_53_0
./bootstrap.sh --with-libraries=mpi,serialization,program_options
echo &quot;using mpi ;&quot; &gt;&gt; project-config.jam
./b2 link=static,shared
sudo ./b2 install
</pre></div>
</div>
<p><em>Compiling with the XL compiler</em></p>
<p>This section is inspired by the Argonne Boost configuration. First, as usual
we call bootstrap.</p>
<div class="highlight-rst"><div class="highlight"><pre>./bootstrap.sh --with-libraries=mpi,serialization,program_options
</pre></div>
</div>
<p>In a next step, download <a class="reference download internal" href="_downloads/bgq.jam"><code class="xref download docutils literal"><span class="pre">jam</span> <span class="pre">file</span></code></a> and
copy the Boost jam file to <code class="docutils literal"><span class="pre">tools/build/v2/tools/</span></code>.
Subsequently, executing</p>
<div class="highlight-rst"><div class="highlight"><pre>echo &quot;using bgq ;&quot; &gt;&gt; project-config.jam
echo &quot;using mpi : /bgsys/drivers/ppcfloor/comm/bin/xl/mpixlcxx ;&quot; &gt;&gt; project-config.jam
./b2 link=static,shared toolset=bgq
</pre></div>
</div>
<p>compiles the selected boost libraries (you might need to adapt the path to
<code class="docutils literal"><span class="pre">mpixlcxx</span></code>). In case all versions (debug, mt) are required, use
<code class="docutils literal"><span class="pre">--build-type=complete</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure to only use -O2 because -O3 and higher will result in a
segfault in the compiler for some packages (e.g. <strong class="command">program_options</strong>),
see <a class="reference external" href="http://www-01.ibm.com/support/docview.wss?uid=swg1LI77249">http://www-01.ibm.com/support/docview.wss?uid=swg1LI77249</a>.</p>
</div>
</div>
<div class="section" id="elemental-0-86">
<h3>Elemental 0.86<a class="headerlink" href="#elemental-0-86" title="Permalink to this headline">¶</a></h3>
<p>Elemental is a framework for distributed-memory dense linear algebra that
strives to be both fast and convenient. It combines ideas including:
element-wise matrix distributions (Hendrickson et al.), object-oriented
submatrix tracking (FLAME, van de Geijn et al.), and first-class matrix
distributions (PLAPACK, van de Geijn et al.).</p>
<p>We support version 0.86. Elemental&#8217;s API is a moving target, so newer versions
might not work as-is.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently version 0.86 is not officially released yet. Please,
use the release candidate, e.g.
<a class="reference external" href="https://github.com/elemental/Elemental/releases/tag/0.86-rc1">https://github.com/elemental/Elemental/releases/tag/0.86-rc1</a>.</p>
</div>
<p><em>Installation: (make sure to use a compiler with c++11 support)</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget https://github.com/elemental/Elemental/releases/tag/0.86-rc1
unzip 0.86-rc1.zip
cd Elemental-0.86-rc1/
rmdir external/metis
git clone https://github.com/poulson/metis.git external/metis
mkdir build
cd build
cmake -DEL_USE_64BIT_INTS=ON -DCMAKE_BUILD_TYPE=HybridRelease ../
make
sudo make install
</pre></div>
</div>
<p>The installation prefix can be set using the <code class="docutils literal"><span class="pre">CMAKE_INSTALL_PREFIX</span></code>.</p>
<p>Note that instead of pulling Metis into the Elemental directory you can set
the Metis path by setting the <cite>METIS_ROOT</cite> environment variable.</p>
<p>If you want to use non-default math libraries specify the <code class="docutils literal"><span class="pre">MATH_LIBS</span></code>
variable.
For example for OpenBLAS, run cmake along the following lines:</p>
<div class="highlight-rst"><div class="highlight"><pre>cmake -D MATH_LIBS=&quot;-L/usr/local/lib -llapack -lopenblas -lm&quot; ..
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that the cmake comamnd above may require additional options for
non-standard Python installations, e.g. Anaconda,
<code class="docutils literal"><span class="pre">-D</span>&nbsp; <span class="pre">PYTHON_LIBRARY=/path/to/libpython2.7.so</span>&nbsp; <span class="pre">-D</span> <span class="pre">PYTHON_INCLUDE_DIR=/path/to/include/python2.7</span></code></p>
</div>
</div>
<div class="section" id="combinatorial-blas-combblas-1-4">
<h3>Combinatorial BLAS (CombBLAS) 1.4<a class="headerlink" href="#combinatorial-blas-combblas-1-4" title="Permalink to this headline">¶</a></h3>
<p>The Combinatorial BLAS is an extensible distributed-memory parallel graph
library offering a small but powerful set of linear algebra primitives
specifically targeting graph analytics. We use it in libSkylark to represent
sparse matrices.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://gauss.cs.ucsb.edu/~aydin/CombBLAS_FILES/CombBLAS_beta_14_0.tgz
tar xvfz CombBLAS_beta_14_0.tgz
cd CombBLAS/
cmake .
make
</pre></div>
</div>
<p><em>Shared Libs</em></p>
<p>In order to use libSkylark through Python, make sure to compile and append the
directory containing the <code class="docutils literal"><span class="pre">*.so</span></code> files to your <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal"><span class="pre">LD_LIBRARY_PATH</span></code>.</p>
<div class="highlight-rst"><div class="highlight"><pre>cd CombBLAS/
rm CMakeCache.txt
cmake -DBUILD_SHARED_LIBS:BOOL=ON .
make
</pre></div>
</div>
</div>
<div class="section" id="kdt">
<h3>KDT<a class="headerlink" href="#kdt" title="Permalink to this headline">¶</a></h3>
<p>The Knowledge Discovery Toolbox (KDT) provides a Python interface (amongst
other things) to CombBLAS. libSkylark requires this package to handle sparse
matrices through the Python interface.</p>
<p>To install kdt you need python and python-dev libs:</p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install python
sudo apt-get install python-dev
</pre></div>
</div>
<p>Head over to <a class="reference external" href="http://kdt.sourceforge.net/wiki/index.php/Download">http://kdt.sourceforge.net/wiki/index.php/Download</a> and
download kdt-0.3.tar.gz. Then execute:</p>
<div class="highlight-rst"><div class="highlight"><pre>tar xzf kdt-0.3.tar.gz
cd kdt-0.3
export CC=mpicxx
export CXX=mpicxx
python setup.py build
sudo python setup.py install
</pre></div>
</div>
<p>See <a class="reference external" href="http://kdt.sourceforge.net/wiki/index.php/Installation">http://kdt.sourceforge.net/wiki/index.php/Installation</a> for further
information.</p>
</div>
<div class="section" id="fftw-3-3-3">
<h3>FFTW 3.3.3<a class="headerlink" href="#fftw-3-3-3" title="Permalink to this headline">¶</a></h3>
<p>FFTW is a C subroutine library for computing the discrete Fourier transform
(DFT) in one or more dimensions, of arbitrary input size, and of both real and
complex data (as well as of even/odd data, i.e. the discrete cosine/sine
transforms or DCT/DST).</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://www.fftw.org/fftw-3.3.3.tar.gz
tar xvfz fftw-3.3.3.tar.gz
cd fftw-3.3.3/
./configure --enable-shared
make -j4
sudo make install
</pre></div>
</div>
</div>
<div class="section" id="random123-1-08">
<h3>Random123 1.08<a class="headerlink" href="#random123-1-08" title="Permalink to this headline">¶</a></h3>
<p>Random123 is a library of &#8220;counter-based&#8221; random number generators
(CBRNGs). We use them in libSkylark to generate independent random number
streams.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>wget http://www.thesalmons.org/john/random123/releases/1.08/Random123-1.08.tar.gz
tar xvfz Random123-1.08.tar.gz
sudo cp -r Random123-1.08/include/Random123 /usr/local/include
</pre></div>
</div>
</div>
<div class="section" id="doxygen">
<h3>Doxygen<a class="headerlink" href="#doxygen" title="Permalink to this headline">¶</a></h3>
<p>Doxygen is a documentation generator, a tool for writing software reference
documentation. The documentation is written within code, and is thus
relatively easy to keep up to date. Doxygen can cross reference
documentation and code, so that the reader of a document can easily refer
to the actual code.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install doxygen
</pre></div>
</div>
</div>
<div class="section" id="graphviz">
<h3>Graphviz<a class="headerlink" href="#graphviz" title="Permalink to this headline">¶</a></h3>
<p>Graphviz (short for Graph Visualization Software) is a package of
open-source tools initiated by AT&amp;T Labs Research for drawing graphs
specified in DOT language scripts.</p>
<p><em>Installation:</em></p>
<div class="highlight-rst"><div class="highlight"><pre>sudo apt-get install graphviz
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-libskylark">
<span id="build-libskylark-label"></span><h2>Building libSkylark<a class="headerlink" href="#building-libskylark" title="Permalink to this headline">¶</a></h2>
<p>libSkylark uses Cmake as a build system. Before you start please make
sure to check out the Section &#8220;Installing software dependencies for
libSkylark&#8221; to learn about the required dependencies.</p>
<p><strong>Quick guide</strong>: In many situation the default configuration and settings
should work out of the box. To that end execute</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
CC=mpicc CXX=mpicxx cmake $SRC_DIR
make
make install
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have MPI compilers in your PATH environment variable, CMake
may overwrite the compiler specified in the CXX flag.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to specify the path for BLAS and/or LAPACK (e.g. use OpenBLAS), define
the BLAS_LIBRARIES and LAPACK_LIBRARIES enviroment variable.</p>
</div>
<p>In case you have a more specific setup or this does not work on your
machine continue reading the next sections.</p>
<div class="section" id="python-only-user-level-installation">
<h3>Python only user-level installation<a class="headerlink" href="#python-only-user-level-installation" title="Permalink to this headline">¶</a></h3>
<p>In case you do not have root access, and are satisfied with an Python only
installation, you can install the Python package only at user-level.</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
CC=mpicc CXX=mpicxx cmake $SRC_DIR
make
cd python-skylark
python ./setup.py install --user
</pre></div>
</div>
<p>The Python package will be installed under <code class="file docutils literal"><span class="pre">~/.local</span></code>. The directory <code class="file docutils literal"><span class="pre">~/.local/lib</span></code> should
be in the library load path for the installation to function properly.</p>
</div>
<div class="section" id="directory-setup">
<h3>Directory setup<a class="headerlink" href="#directory-setup" title="Permalink to this headline">¶</a></h3>
<p>For the rest of this section let&#8217;s keep the following conventions:</p>
<blockquote>
<div><ul>
<li><p class="first">the source code is checked out and <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal"><span class="pre">$SRC_DIR</span></code> points to the base directory in the libSkylark repository, e.g.</p>
<blockquote>
<div><div class="highlight-rst"><div class="highlight"><pre>export SRC_DIR=/home/user/workspace/libskylark
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">you created a <strong>separate</strong> (do not build in the $SRC_DIR$) build directory <span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal"><span class="pre">$BUILD_DIR</span></code> that is used to generate object files, libraries and executables, e.g.</p>
<blockquote>
<div><div class="highlight-rst"><div class="highlight"><pre>export BUILD_DIR=/home/user/build/libskylark
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build-options">
<h3>Build options<a class="headerlink" href="#build-options" title="Permalink to this headline">¶</a></h3>
<p>libSkylark accepts build options in order to customize components. The
following table summarizes all currently available build options:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="9%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>USE_FFTW</td>
<td>ON</td>
<td>Build with fftw support</td>
</tr>
<tr class="row-odd"><td>USE_COMBBLAS</td>
<td>OFF</td>
<td>Build with CombBLAS sparse matrix support</td>
</tr>
<tr class="row-even"><td>USE_PROFILER</td>
<td>OFF</td>
<td>Build with internal profiler</td>
</tr>
<tr class="row-odd"><td>USE_HYBRID</td>
<td>OFF</td>
<td>Build in hybrid mode OpenMP and MPI (if Elemental was compiled in hybrid mode, activate)</td>
</tr>
<tr class="row-even"><td>BUILD_PYTHON</td>
<td>ON</td>
<td>Build Python interface</td>
</tr>
<tr class="row-odd"><td>BUILD_EXAMPLES</td>
<td>ON</td>
<td>Build libSkylark examples (see examples directory)</td>
</tr>
<tr class="row-even"><td>BUILD_ML</td>
<td>ON</td>
<td>Build libSkylark with machine learning solvers Build type</td>
</tr>
</tbody>
</table>
<p>You can specify the desired build type with <code class="docutils literal"><span class="pre">-DCMAKE_BUILD_TYPE=STRING</span></code>,
where <code class="docutils literal"><span class="pre">STRING</span></code> is any of</p>
<table border="1" class="docutils">
<colgroup>
<col width="70%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Flags</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>RELWITHDEBINFO</td>
<td>-O3 -g</td>
</tr>
<tr class="row-odd"><td>RELEASE</td>
<td>-O3</td>
</tr>
<tr class="row-even"><td>DEBUG</td>
<td>-O0 -g</td>
</tr>
</tbody>
</table>
<p>The default is RELWITHDEBINFO.</p>
</div>
<div class="section" id="environment-variables">
<h3>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h3>
<p>The installation of libSkylark can be influenced with two variables:</p>
<blockquote>
<div><ul class="simple">
<li>the CMake parameter <code class="docutils literal"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> (i.e. pass <code class="docutils literal"><span class="pre">-DCMAKE_INSTALL_PREFIX=/home/user/software</span></code> when calling <strong class="command">cmake</strong>), and</li>
<li>the environment variable <span class="target" id="index-5"></span><code class="xref std std-envvar docutils literal"><span class="pre">$PYTHON_SITE_PACKAGES</span></code> to determine the installation location for python packages. Don&#8217;t forget to adapt the <span class="target" id="index-6"></span><code class="xref std std-envvar docutils literal"><span class="pre">$PYTHONPATH</span></code> environment variable as well. Example: If <span class="target" id="index-7"></span><code class="xref std std-envvar docutils literal"><span class="pre">$PYTHON_SITE_PACKAGES</span></code> is set to <code class="file docutils literal"><span class="pre">/home/user/local</span></code>, CMake will install the Python bindings under <code class="file docutils literal"><span class="pre">/home/user/local/lib/python2.7/site-packages/skylark</span></code>. At this point, you will have to append <span class="target" id="index-8"></span><code class="xref std std-envvar docutils literal"><span class="pre">$PYTHONPATH</span></code> with <code class="file docutils literal"><span class="pre">/home/user/local/lib/python2.7/site-packages</span></code>!</li>
</ul>
</div></blockquote>
<p>To help CMake to locate installed dependencies (system-wide installed dependencies should be found automatically), you should set the following environment variables:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ELEMENTAL_ROOT</td>
<td>Looks for headers in <span class="target" id="index-9"></span><code class="xref std std-envvar docutils literal"><span class="pre">$ELEMENTAL_ROOT</span></code>/include and libs in <span class="target" id="index-10"></span><code class="xref std std-envvar docutils literal"><span class="pre">$ELEMENTAL_ROOT</span></code>/lib</td>
</tr>
<tr class="row-odd"><td>COMBBLAS_ROOT</td>
<td>Looks for headers in <span class="target" id="index-11"></span><code class="xref std std-envvar docutils literal"><span class="pre">$COMBBLAS_ROOT</span></code>/ and libs in <span class="target" id="index-12"></span><code class="xref std std-envvar docutils literal"><span class="pre">$COMBBLAS_ROOT</span></code>/lib</td>
</tr>
<tr class="row-even"><td>FTW_ROOT</td>
<td>Looks for headers in <span class="target" id="index-13"></span><code class="xref std std-envvar docutils literal"><span class="pre">$FFTW_ROOT</span></code>/include and libs in <span class="target" id="index-14"></span><code class="xref std std-envvar docutils literal"><span class="pre">$FFTW_ROOT</span></code>/lib</td>
</tr>
<tr class="row-odd"><td>BOOST_ROOT</td>
<td>For non system-wide boost installations</td>
</tr>
<tr class="row-even"><td>RANDOM123_ROOT</td>
<td>Looks for headers in <span class="target" id="index-15"></span><code class="xref std std-envvar docutils literal"><span class="pre">$RANDOM_123_ROOT</span></code>/include</td>
</tr>
<tr class="row-odd"><td>HDF5_ROOT</td>
<td>Looks for headers in <span class="target" id="index-16"></span><code class="xref std std-envvar docutils literal"><span class="pre">$HDF5_ROOT</span></code>/include and libs in <span class="target" id="index-17"></span><code class="xref std std-envvar docutils literal"><span class="pre">$HDF5_ROOT</span></code>/lib</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configuring-compiling-and-installing-libskylark">
<h3>Configuring, compiling and installing libSkylark<a class="headerlink" href="#configuring-compiling-and-installing-libskylark" title="Permalink to this headline">¶</a></h3>
<p>Finally we are ready to configure, compile and install libSkylark. The default configuration (compiling Elemental and Python
support, installed system-wide) can be compiled and installed with:</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
CC=mpicc CXX=mpicxx cmake $SRC_DIR
make
make install
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have MPI compilers in your PATH CMake will use the most generic
(e.g. <strong class="command">mpicxx</strong>) version
(see <a class="reference external" href="https://github.com/Kitware/CMake/blob/master/Modules/FindMPI.cmake#L113">https://github.com/Kitware/CMake/blob/master/Modules/FindMPI.cmake#L113</a>).
This may overwrite the compiler specified in the CXX flag.</p>
</div>
<p>The Python packages will most likely be installed under
<code class="file docutils literal"><span class="pre">/usr/lib/pythonX.Y/dist-packages</span></code> (OS and version dependent). Check the
configure output for more details about default installation paths on your machine.</p>
<p>For the sake of illustration let&#8217;s assume you want to enable CombBLAS support
and install everything in <code class="file docutils literal"><span class="pre">~/local</span></code>:</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
export PYTHON_SITE_PACKAGES=~/local/
CC=mpicc CXX=mpicxx cmake -DCMAKE_INSTALL_PREFIX=~/local -DWITH_COMBBLAS=ON $SRC_DIR
make
make install
</pre></div>
</div>
<p>Notice that we set the <span class="target" id="index-18"></span><code class="xref std std-envvar docutils literal"><span class="pre">PYTHON_SITE_PACKAGES</span></code> and passed a
<code class="docutils literal"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> to the <strong class="command">cmake</strong> command above. Additionally we
enabled CombBLAS support. Note that you have to make sure that the required
libraries are compiled and the environment variables correctly point to the
installation locations (i.e. <code class="docutils literal"><span class="pre">export</span> <span class="pre">COMBBLAS_ROOT=~/software/combblas/</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a specific linking type wants to be enforced, check out the CMake
variable <code class="docutils literal"><span class="pre">CMAKE_FIND_LIBRARY_SUFFIXES</span></code> (e.g. use
<code class="docutils literal"><span class="pre">SET(CMAKE_FIND_LIBRARY_SUFFIXES</span> <span class="pre">&quot;.so&quot;</span></code>).</p>
</div>
</div>
<div class="section" id="code-documentation-doxygen">
<h3>Code documentation Doxygen<a class="headerlink" href="#code-documentation-doxygen" title="Permalink to this headline">¶</a></h3>
<p>To generate the documentation (see dependency section for Doxygen installation), run</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
make doc
</pre></div>
</div>
<p>This will generate the Doxygen documentation under <code class="file docutils literal"><span class="pre">$BUILD_DIR/Documentation</span></code>.
To read the documentation open <code class="file docutils literal"><span class="pre">$BUILD_DIR/Documentation/html/index.html</span></code> in a browser.</p>
</div>
<div class="section" id="sphinx">
<h3>Sphinx<a class="headerlink" href="#sphinx" title="Permalink to this headline">¶</a></h3>
<p>Make sure to install the Sphinx dependencies before you run make sphinx-doc:</p>
<div class="highlight-sh"><div class="highlight"><pre>apt-get install python-sphinx
<span class="nb">cd</span> /tmp
svn co https://svn.code.sf.net/p/matplotlib/code/trunk/sampledoc_tut
mkdir <span class="nv">$HOME</span>/.sphinx_ext
cp sampledoc_tut/sphinxext/*.py <span class="nv">$HOME</span>/.sphinx_ext
rm -rf /tmp/sampledoc_tut

<span class="nb">export </span><span class="nv">SPHINXEXT</span><span class="o">=</span><span class="nv">$HOME</span>/.sphinx_ext
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Sphinx requires some dependencies, e.g. plots and latex equations.</p>
<div class="last highlight-sh"><div class="highlight"><pre>apt-get python-dateutil
apt-get libfreetype6-dev libpng-dev
easy-install matplotlib
apt-get install texlive-latex-base
apt-get install texlive-latex-extra
</pre></div>
</div>
</div>
<p>Then run</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$BUILD_DIR</span>
make sphinx-doc
</pre></div>
</div>
<p>and point your browser to <code class="file docutils literal"><span class="pre">$BUILD_DIR/Documentation/sphinx/index.html</span></code>.</p>
</div>
<div class="section" id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<p>In order to run unit tests, execute</p>
<div class="highlight-rst"><div class="highlight"><pre>cd $BUILD_DIR
make test
</pre></div>
</div>
</div>
<div class="section" id="running-examples">
<h3>Running examples<a class="headerlink" href="#running-examples" title="Permalink to this headline">¶</a></h3>
<p>There are two examples in the example folder (for more see python-skylark).
The elemental.cpp shows how C++ code can utilize libSkylark. Run</p>
<div class="highlight-rst"><div class="highlight"><pre>examples/elemental -help
</pre></div>
</div>
<p>in the <span class="target" id="index-19"></span><code class="xref std std-envvar docutils literal"><span class="pre">$BUILD_DIR</span></code> to get a list of available command line options.</p>
</div>
<div class="section" id="linking-against-libskylark">
<h3>Linking against libSkylark<a class="headerlink" href="#linking-against-libskylark" title="Permalink to this headline">¶</a></h3>
<p>If you plan to use libSkylark as a library in your project, the following steps
are necessary to build and link your application:</p>
<blockquote>
<div><ul>
<li><p class="first">add the include path of all libSkylark headers: <code class="file docutils literal"><span class="pre">$</span><em><span class="pre">SKYLARK_INSTALL_DIR</span></em><span class="pre">/include</span></code> (if configured with <code class="docutils literal"><span class="pre">-DCMAKE_INSTALL_PREFIX=${SKYLARK_INSTALL_DIR}</span></code>,</p>
</li>
<li><dl class="first docutils">
<dt>link against all external libraries used when building libSkylark (take a look and maybe reuse the find modules in <code class="file docutils literal"><span class="pre">$</span><em><span class="pre">SRC_DIR</span></em><span class="pre">/CMakeModules</span></code>:</dt>
<dd><ul class="first last simple">
<li>FFTW: fftw3.h</li>
<li>Elemental: header files, libelemental, libpmrrr</li>
<li>CombBLAS: header files, libMPITypelib, libCommGridlib, libMemoryPoollib</li>
<li>Random123: threefry.h, MicroURNG.hpp</li>
<li>HDF5: hdf5.h, libhdf5, libhdf5_cpp</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="using-cmake">
<h3>Using Cmake<a class="headerlink" href="#using-cmake" title="Permalink to this headline">¶</a></h3>
<p>If you are using Cmake to build your application you can use the CMake
configuration file
<code class="file docutils literal"><span class="pre">$</span><em><span class="pre">SKYLARK_INSTALL_DIR</span></em><span class="pre">/lib/SKYLARK/SKYLARKConfig.cmake</span></code> in your
<code class="docutils literal"><span class="pre">CMakeLists.txt</span></code> to find <code class="docutils literal"><span class="pre">SKYLARK</span></code>. After that you can simply
include <code class="docutils literal"><span class="pre">${SKYLARK_INCLUDE_DIRS}</span></code> and <code class="docutils literal"><span class="pre">${SKYLARK_LIBRARIES}</span></code> when you
build and link your application. A very basic CMake file for your project could
look like:</p>
<div class="highlight-rst"><div class="highlight"><pre>cmake_minimum_required (VERSION 2.8.2)
project (SAMPLE)

find_package (SKYLARK REQUIRED HINT ${SKYLARK_INSTALL_DIR}/lib)

include_directories ( ${SKYLARK_INCLUDE_DIRS} )
add_definitions(${SKYLARK_DEFS})

add_executable(ex_code elemental.cpp)
target_link_libraries(ex_code ${SKYLARK_LIBRARIES} )
set_target_properties(ex_code PROPERTIES COMPILE_FLAGS &quot;${SKYLARK_CXX_FLAGS}&quot; )
</pre></div>
</div>
<p>This will pull all the required libs and add all include paths for libSkylark and
its dependencies. You should be able to compile
your application painless by following the above recipe.</p>
</div>
<div class="section" id="using-xyz-build-system">
<h3>Using XYZ Build System<a class="headerlink" href="#using-xyz-build-system" title="Permalink to this headline">¶</a></h3>
<p>Take a look at the file in <code class="file docutils literal"><span class="pre">$</span><em><span class="pre">SKYLARK_INSTALL_DIR</span></em><span class="pre">/lib/SKYLARK/SKYLARKConfig.cmake</span></code>
to see which include directories libraries you have to include when using libSkylark.</p>
</div>
</div>
<div class="section" id="software-pitfalls">
<h2>Software Pitfalls<a class="headerlink" href="#software-pitfalls" title="Permalink to this headline">¶</a></h2>
<div class="section" id="combblas-installation-notes">
<h3>CombBLAS Installation Notes<a class="headerlink" href="#combblas-installation-notes" title="Permalink to this headline">¶</a></h3>
<p>The general steps to use CombBLAS with libSkylark:</p>
<blockquote>
<div><ul class="simple">
<li>Download KDT, build and install the python package (generated with SWIG), then</li>
<li>Download CombBLAS, build and install libs and include files, and finally</li>
<li>When configuring libSkylark, use <code class="docutils literal"><span class="pre">-DWITH_COMBBLAS=ON</span></code> in the CMake configure call</li>
</ul>
</div></blockquote>
<p><strong>Issues with CombBLAS &gt;= 1.4.0</strong></p>
<p>Unfortunately there are some issues when using CombBLAS with libSkylark. Check
the subsections below if you have problem compiling or linking CombBLAS.</p>
<p><strong>UINT32_MAX not declared</strong></p>
<p>Additionally a CombBLAS header causes the compiler to produce an error
(<code class="docutils literal"><span class="pre">UINT32_MAX</span> <span class="pre">not</span> <span class="pre">declared</span></code>). There are two possible ways to fix that:</p>
<blockquote>
<div><ul class="simple">
<li>Edit the header (RefGen21.h) and replace <code class="docutils literal"><span class="pre">UINT32_MAX</span></code> with <code class="docutils literal"><span class="pre">std::numeric_limits&lt;unit32_t&gt;::max()</span></code>, or</li>
<li>add the <code class="docutils literal"><span class="pre">-D__STDC_LIMIT_MACROS</span></code> compile flag in the CMake file when CombBLAS is enabled.</li>
</ul>
</div></blockquote>
<p><strong>Compiler Warning: *enumeral* and *non-enumeral* type in conditional expression</strong></p>
<p>To fix the following warning (appearing when compiling with <code class="docutils literal"><span class="pre">-Werror</span></code>):</p>
<div class="highlight-rst"><div class="highlight"><pre>CombBLAS_beta_13_0/psort-1.0/driver/MersenneTwister.h: In member function ‘void MTRand::seed(MTRand::uint32*, MTRand::uint32)’:
CombBLAS_beta_13_0/psort-1.0/driver/MersenneTwister.h:234:42: error: enumeral and non-enumeral type in conditional expression [-Werror]
</pre></div>
</div>
<p>apply the following patch:</p>
<div class="highlight-rst"><div class="highlight"><pre>diff --git a/psort-1.0/driver/MersenneTwister.h b/psort-1.0/driver/MersenneTwister.h
index 16e6458..1363423 100644
--- a/psort-1.0/driver/MersenneTwister.h
+++ b/psort-1.0/driver/MersenneTwister.h
@@ -231,7 +231,7 @@ inline void MTRand::seed( uint32 *const bigSeed, const uint32 seedLength )
        initialize(19650218UL);
        register int i = 1;
        register uint32 j = 0;
<span class="m">-</span>       register int k = ( N &gt; seedLength ? N : seedLength );
<span class="m">+</span>       register int k = ( static_cast&lt;uint32&gt;(N) &gt; seedLength ? static_cast&lt;uint32&gt;(N) : seedLength );
        for( ; k; --k )
        {
                state[i] =
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This should be fixed upstream in the next CombBLAS release (most likely 1.3.1).</p>
</div>
<p><strong>Compiling Skylark/CombBLAS with CLANG</strong></p>
<p>To be able to compile and link using the CLANG compiler (&gt;=3.0.x), the
following patch has to be applied to CombBLAS (&lt;= 1.3.0):</p>
<div class="highlight-rst"><div class="highlight"><pre>diff --git a/DistEdgeList.cpp b/DistEdgeList.cpp
index 5ae9301..61cf16f 100644
--- a/DistEdgeList.cpp
+++ b/DistEdgeList.cpp
@@ -102,7 +102,7 @@ void DistEdgeList&lt;IT&gt;::Dump64bit(string filename)
        MPI_Comm_rank(World, &amp;rank);
        MPI_Comm_size(World, &amp;nprocs);
        MPI_File thefile;
<span class="m">-</span>       MPI_File_open(World, filename.c_str(), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);
<span class="m">+</span>       MPI_File_open(World, const_cast&lt;char*&gt;(filename.c_str()), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);

        IT * prelens = new IT[nprocs];
        prelens[rank] = 2*nedges;
@@ -125,7 +125,7 @@ void DistEdgeList&lt;IT&gt;::Dump32bit(string filename)
        MPI_Comm_rank(World, &amp;rank);
        MPI_Comm_size(World, &amp;nprocs);
        MPI_File thefile;
<span class="m">-</span>       MPI_File_open(World, filename.c_str(), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);
<span class="m">+</span>       MPI_File_open(World, const_cast&lt;char*&gt;(filename.c_str()), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);

        IT * prelens = new IT[nprocs];
        prelens[rank] = 2*nedges;
diff --git a/SpParMat.cpp b/SpParMat.cpp
index ca553e8..2ef88d6 100644
--- a/SpParMat.cpp
+++ b/SpParMat.cpp
@@ -109,7 +109,7 @@ void SpParMat&lt; IT,NT,DER &gt;::Dump(string filename) const
        int nprocs = commGrid-&gt;GetSize();

        MPI_File thefile;
<span class="m">-</span>       MPI_File_open(World, filename.c_str(), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);
<span class="m">+</span>       MPI_File_open(World, const_cast&lt;char*&gt;(filename.c_str()), MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;thefile);

        int rankinrow = commGrid-&gt;GetRankInProcRow();
        int rankincol = commGrid-&gt;GetRankInProcCol();
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The issues in the above patch were addressed (source lines
commented) in the 1.4.0 CombBLAS release (January 2014).</p>
</div>
<p><strong>Warning: variable ‘XYZ’ set but not used</strong></p>
<p>CombBLAS (&lt;=1.4.0) has set but not used variables. To remove the warning apply
the following patch.</p>
<div class="highlight-rst"><div class="highlight"><pre>diff --git a/SpMat.cpp b/SpMat.cpp
index d00f37c..6ae6050 100644
--- a/SpMat.cpp
+++ b/SpMat.cpp
@@ -108,27 +108,28 @@ SpTuples&lt;IU, NUO&gt; * MultiplyReturnTuples
                                bool clearA = false, bool clearB = false)

{
<span class="m">-</span>       IU A_m, A_n, B_m, B_n;
<span class="m">+</span>       //IU A_m, A_n, B_m, B_n;
<span class="m">+</span>       IU A_n, B_m;

        if(isAT)
        {
<span class="m">-</span>               A_m = A.getncol();
<span class="m">+</span>               //A_m = A.getncol();
                A_n = A.getnrow();
        }
        else
        {
<span class="m">-</span>               A_m = A.getnrow();
<span class="m">+</span>               //A_m = A.getnrow();
                A_n = A.getncol();
        }
        if(isBT)
        {
                B_m = B.getncol();
<span class="m">-</span>               B_n = B.getnrow();
<span class="m">+</span>               //B_n = B.getnrow();
        }
        else
        {
                B_m = B.getnrow();
<span class="m">-</span>               B_n = B.getncol();
<span class="m">+</span>               //B_n = B.getncol();
        }

        if(A_n == B_m)
</pre></div>
</div>
<p><strong>Disable KDT Log</strong></p>
<p>To disable the KDT log use the following patch:</p>
<div class="highlight-rst"><div class="highlight"><pre>diff --git a/kdt/Graph.py b/kdt/Graph.py
index 51c55b2..e61e9cf 100644
--- a/kdt/Graph.py
+++ b/kdt/Graph.py
@@ -1,7 +1,7 @@
 import math
 #import numpy as np # Adam: TRY TO AVOID THIS IF AT ALL POSSIBLE.
import pyCombBLAS as pcb
-import feedback
+#import feedback
import UFget as uf

from Util import info, master, version, revision
diff --git a/kdt/Vec.py b/kdt/Vec.py
index 00b7c1c..50aaa73 100644
--- a/kdt/Vec.py
+++ b/kdt/Vec.py
@@ -1,6 +1,6 @@
import math
import kdt.pyCombBLAS as pcb
-import feedback
+#import feedback
import UFget as uf
import Mat as Mat
import ctypes
diff --git a/kdt/__init__.py b/kdt/__init__.py
index 7f0992f..6c3a10f 100644
--- a/kdt/__init__.py
+++ b/kdt/__init__.py
@@ -10,7 +10,7 @@ from Vec import Vec
from Mat import Mat
#from SpVec import SpVec, info
#from DeVec import DeVec
-from feedback import sendFeedback
+#from feedback import sendFeedback
from UFget import UFget, UFdownload
try:
        import kdt.pyCombBLAS as pcb
diff --git a/setup.py b/setup.py
index a2813e3..10f5bdf 100644
--- a/setup.py
+++ b/setup.py
@@ -369,7 +369,7 @@ pyCombBLAS_ext = Extension(&#39;kdt._pyCombBLAS&#39;,
        extra_link_args = extra_link_args, extra_compile_args = extra_compile_args,
        define_macros=[(&#39;GRAPH_GENERATOR_SEQ&#39;, &#39;1&#39;)] + headerDefs + define_macros)

-py_modules = [&#39;kdt.pyCombBLAS&#39;, &#39;kdt.Graph&#39;, &#39;kdt.DiGraph&#39;, &#39;kdt.HyGraph&#39;, &#39;kdt.feedback&#39;, &#39;kdt.UFget&#39;, &#39;kdt.Mat&#39;, &#39;kdt.Vec&#39;, &#39;kdt.ObjMethods&#39;, &#39;kdt.Algorithms&#39;, &#39;kdt.Util&#39;, &#39;kdt.SpectralClustering&#39;, &#39;kdt.eig&#39;]
+py_modules = [&#39;kdt.pyCombBLAS&#39;, &#39;kdt.Graph&#39;, &#39;kdt.DiGraph&#39;, &#39;kdt.HyGraph&#39;, &#39;kdt.UFget&#39;, &#39;kdt.Mat&#39;, &#39;kdt.Vec&#39;, &#39;kdt.ObjMethods&#39;, &#39;kdt.Algorithms&#39;, &#39;kdt.Util&#39;, &#39;kdt.SpectralClustering&#39;, &#39;kdt.eig&#39;]
# SEJITS modules:
py_modules.extend([&#39;kdt.specializer.__init__&#39;, &#39;kdt.specializer.parsetab&#39;, &#39;kdt.specializer.pcb_function&#39;, &#39;kdt.specializer.pcb_function_frontend&#39;, &#39;kdt.specializer.pcb_function_sm&#39;, &#39;kdt.specializer.pcb_operator_convert&#39;, &#39;kdt.specializer.pcb_predicate&#39;, &#39;kdt.specializer.pcb_predicate_frontend&#39;, &#39;kdt.specializer.pcb_predicate_sm&#39;])
</pre></div>
</div>
</div>
<div class="section" id="issues-with-combblas-1-4-0">
<h3>Issues with CombBLAS &lt; 1.4.0<a class="headerlink" href="#issues-with-combblas-1-4-0" title="Permalink to this headline">¶</a></h3>
<p><strong>std:: namespace clash (CombBLAS &lt;= 1.3.0)</strong></p>
<p>Depending on your compiler version (and if you installed CombBLAS &lt;= 1.3.0)
you might need to apply the following patch:</p>
<div class="highlight-rst"><div class="highlight"><pre>diff --git a/psort-1.0/src/psort_merge.h b/psort-1.0/src/psort_merge.h
index 858580b..256c3db 100644
--- a/psort-1.0/src/psort_merge.h
+++ b/psort-1.0/src/psort_merge.h
@@ -163,11 +163,11 @@ namespace vpsort {
                    out, comp);
       } else if (locs[next] == 0) {
        // 10 =&gt; backwards out of place
<span class="m">-</span>       std::merge (reverse_iterator&lt;_RandomAccessIter&gt; (in + disps[nproc]),
<span class="m">-</span>                   reverse_iterator&lt;_RandomAccessIter&gt; (in + disps[next]),
<span class="m">-</span>                   reverse_iterator&lt;_RandomAccessIter&gt; (out + disps[next]),
<span class="m">-</span>                   reverse_iterator&lt;_RandomAccessIter&gt; (out),
<span class="m">-</span>                   reverse_iterator&lt;_RandomAccessIter&gt; (out + disps[nproc]),
<span class="m">+</span>       std::merge (std::reverse_iterator&lt;_RandomAccessIter&gt; (in + disps[nproc]),
<span class="m">+</span>                   std::reverse_iterator&lt;_RandomAccessIter&gt; (in + disps[next]),
<span class="m">+</span>                   std::reverse_iterator&lt;_RandomAccessIter&gt; (out + disps[next]),
<span class="m">+</span>                   std::reverse_iterator&lt;_RandomAccessIter&gt; (out),
<span class="m">+</span>                   std::reverse_iterator&lt;_RandomAccessIter&gt; (out + disps[nproc]),
                    not2 (comp));
       } else {
        // 11 =&gt; in-place
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This was fixed upstream in the 1.4.0 CombBLAS release (January 2014).</p>
</div>
</div>
</div>
<div class="section" id="complete-bgq-installation-instructions">
<h2>Complete BGQ Installation Instructions<a class="headerlink" href="#complete-bgq-installation-instructions" title="Permalink to this headline">¶</a></h2>
<p>This is an end-to-end guide for installing libSkylark on a BG/Q. During this
section we assume the following:</p>
<ul class="simple">
<li>most of the software and sources are installed in <cite>$HOME/local</cite>,</li>
<li>the installation of Random123 is omitted (just untar the library)</li>
</ul>
<div class="section" id="llvm-clang">
<h3>LLVM/Clang<a class="headerlink" href="#llvm-clang" title="Permalink to this headline">¶</a></h3>
<p>Because of various dependencies and <cite>c++11</cite> compatibility issues the
installation requires a <cite>c++11</cite> compiler. For this we are installing LLVM/Clang
(until the XL compiler provides the necessary <cite>c++11</cite> features.</p>
<p>Argonne provides rpm packages for the BG/Q. Download and follow the
instructions as stated on <a class="reference external" href="https://trac.alcf.anl.gov/projects/llvm-bgq">https://trac.alcf.anl.gov/projects/llvm-bgq</a>.</p>
<p>After this step we assume you have installed LLVM/CLANG under <cite>$HOME/bgclang/</cite>.</p>
</div>
<div class="section" id="elemental">
<h3>Elemental<a class="headerlink" href="#elemental" title="Permalink to this headline">¶</a></h3>
<p>Download elemental 0.83 (<a class="reference external" href="http://libelemental.org/pub/releases/elemental-0.83.tgz">http://libelemental.org/pub/releases/elemental-0.83.tgz</a>).
Then use the following toolchain file (e.g. save to <cite>BGQ-toolchain.cmake</cite>)</p>
<div class="highlight-cmake"><div class="highlight"><pre>set(GCC_ROOT  &quot;/bgsys/drivers/ppcfloor/gnu-linux&quot;)
set(GCC_NAME  &quot;powerpc64-bgq-linux&quot;)
set(CLANG_ROOT &quot;$ENV{HOME}/bgclang/bin&quot;)
set(CLANG_MPI_ROOT &quot;$ENV{HOME}/bgclang/mpi/bgclang&quot;)
set(IBMCMP_ROOT &quot;$ENV{IBM_MAIN_DIR}&quot;)

set(BLAS_LIB &quot;$ENV{HOME}/src/lapack-3.5.0/&quot;)
set(LAPACK_LIB &quot;$ENV{HOME}/src/lapack-3.5.0/&quot;)
set(ESSL_LIB &quot;/opt/ibmmath/lib64&quot;)

set(MPI_ROOT   &quot;/bgsys/drivers/ppcfloor/comm/gcc&quot;)
set(PAMI_ROOT  &quot;/bgsys/drivers/ppcfloor/comm/sys&quot;)
set(SPI_ROOT   &quot;/bgsys/drivers/ppcfloor/spi&quot;)

# The serial compilers
set(CMAKE_C_COMPILER   &quot;${CLANG_MPI_ROOT}/bin/mpiclang&quot;)
set(CMAKE_CXX_COMPILER &quot;${CLANG_MPI_ROOT}/bin/mpiclang++11&quot;)
set(CMAKE_Fortran_COMPILER &quot;${GCC_ROOT}/bin/${GCC_NAME}-gfortran&quot;)

# The MPI wrappers for the C and C++ compilers
set(MPI_C_COMPILER   &quot;${CLANG_MPI_ROOT}/bin/mpiclang&quot;)
set(MPI_CXX_COMPILER &quot;${CLANG_MPI_ROOT}/bin/mpiclang++11&quot;)

set(MPI_C_COMPILE_FLAGS    &quot;&quot;)
set(MPI_CXX_COMPILE_FLAGS  &quot;&quot;)
set(MPI_C_INCLUDE_PATH     &quot;${MPI_ROOT}/include&quot;)
set(MPI_CXX_INCLUDE_PATH   &quot;${MPI_ROOT}/include&quot;)
set(MPI_C_LINK_FLAGS       &quot;-L${MPI_ROOT}/lib -L${PAMI_ROOT}/lib -L${SPI_ROOT}/lib&quot;)
set(MPI_CXX_LINK_FLAGS     &quot;${MPI_C_LINK_FLAGS}&quot;)
set(MPI_C_LIBRARIES       &quot;${MPI_C_LINK_FLAGS}   -lSPI -lSPI_cnk -lrt -lpthread -lstdc++ -lpthread&quot;)
set(MPI_CXX_LIBRARIES     &quot;${MPI_CXX_LINK_FLAGS} ${MPI_C_LIBRARIES}&quot;)

if(CMAKE_BUILD_TYPE MATCHES PureDebug OR
CMAKE_BUILD_TYPE MATCHES HybridDebug)
set(CXX_FLAGS &quot;-g&quot;)
else()
set(CXX_FLAGS &quot;-O3&quot;)
endif()

set(CMAKE_THREAD_LIBS_INIT &quot;-fopenmp&quot;)
set(OpenMP_CXX_FLAGS &quot;-fopenmp&quot;)

##############################################################

# set the search path for the environment coming with the compiler
# and a directory where you can install your own compiled software
set(CMAKE_FIND_ROOT_PATH
    /bgsys/drivers/ppcfloor
    /bgsys/drivers/ppcfloor/spi
    $ENV{HOME}/bgclang/mpi/bgclang
)

# adjust the default behaviour of the FIND_XXX() commands:
# search headers and libraries in the target environment, search
# programs in the host environment
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)

##############################################################

set(XLF_LIB &quot;/opt/ibmcmp/xlf/bg/14.1/bglib64&quot;)
set(XLSMP_LIB &quot;/opt/ibmcmp/xlsmp/bg/3.1/bglib64&quot;)
if(CMAKE_BUILD_TYPE MATCHES PureDebug OR
CMAKE_BUILD_TYPE MATCHES PureRelease)
set(MATH_LIBS &quot;-L${ESSL_LIB} -lesslbg -L${LAPACK_LIB} -llapack -L${ESSL_LIB} -lesslbg -L${XLF_LIB} -lxlf90_r -L${XLSMP_LIB} -lxlomp_ser -lxlopt -lxlfmath -lxl -lpthread -ldl -Wl,--allow-multiple-definition&quot;)
else()
set(MATH_LIBS &quot;-L${ESSL_LIB} -lesslsmpbg -L${LAPACK_LIB} -llapack -L${ESSL_LIB} -lesslsmpbg -L${XLF_LIB} -lxlf90_r -L${XLSMP_LIB} -lxlsmp -lxlopt -lxlfmath -lxl -lpthread -ldl -Wl,--allow-multiple-definition&quot;)
endif()
</pre></div>
</div>
<p>This toolchain file is based on the (Elemental) provided
<cite>BGQ-Mira-clang-essl.cmake</cite> file.
Finally, run the following to compile (and install) Elemental.</p>
<div class="highlight-sh"><div class="highlight"><pre>rm -rf CMake*<span class="p">;</span> <span class="se">\</span>
cmake -DCMAKE_TOOLCHAIN_FILE<span class="o">=</span>BGQ-toolchain.cmake <span class="se">\</span>
    -DCMAKE_INSTALL_PREFIX<span class="o">=</span><span class="nv">$HOME</span>/local <span class="se">\</span>
    -DCMAKE_BUILD_TYPE<span class="o">=</span>HybridRelease -DEL_EXAMPLES<span class="o">=</span>OFF <span class="se">\</span>
    -DBUILD_SHARED_LIBS<span class="o">=</span>OFF <span class="se">\</span>
    -DEL_USE_64BIT_INTS<span class="o">=</span>ON -DBUILD_METIS<span class="o">=</span>OFF ..
make install
</pre></div>
</div>
<p>In case you run into errors or problems, check the <cite>CMakeFiles/CMakeError.log</cite>
file in the build directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It seems that the <cite>HybridDebug</cite> version is causing problems on the BGQ.</p>
</div>
</div>
<div class="section" id="combblas">
<h3>CombBLAS<a class="headerlink" href="#combblas" title="Permalink to this headline">¶</a></h3>
<p>Download <a class="reference external" href="http://gauss.cs.ucsb.edu/~aydin/CombBLAS_FILES/CombBLAS_beta_14_0.tgz">http://gauss.cs.ucsb.edu/~aydin/CombBLAS_FILES/CombBLAS_beta_14_0.tgz</a>
untar and change to the CombBLAS directory.</p>
<p>First we need to fix the CombBLAS <cite>CMakeLists.txt</cite> by commenting out the
following two lines:</p>
<div class="highlight-cmake"><div class="highlight"><pre><span class="c">#SET(CMAKE_CXX_COMPILER mpicxx)</span>
<span class="c">#SET(CMAKE_C_COMPILER mpicc)</span>
</pre></div>
</div>
<p>and then run to build the required libraries</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang <span class="se">\</span>
<span class="nv">CXX</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang++11 <span class="se">\</span>
cmake .
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The examples and test might fail to compile but that&#8217;s ok for now.</p>
</div>
</div>
<div class="section" id="fftw">
<h3>FFTW<a class="headerlink" href="#fftw" title="Permalink to this headline">¶</a></h3>
<p>Download <a class="reference external" href="http://www.fftw.org/fftw-3.3.3.tar.gz">http://www.fftw.org/fftw-3.3.3.tar.gz</a>.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang <span class="se">\</span>
<span class="nv">CXX</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang++11 <span class="se">\</span>
./configure
make
</pre></div>
</div>
</div>
<div class="section" id="boost">
<h3>Boost<a class="headerlink" href="#boost" title="Permalink to this headline">¶</a></h3>
<p>Download Boost 1.53.0, untar, change directory and then execute:</p>
<div class="highlight-sh"><div class="highlight"><pre>./bootstrap.sh --with-libraries<span class="o">=</span>mpi,serialization,program_options
<span class="nb">echo</span> <span class="s2">&quot;using mpi : </span><span class="nv">$HOME</span><span class="s2">/bgclang/mpi/bgclang/bin/mpiclang++11 ;&quot;</span> &gt;&gt; project-config.jam
./b2 <span class="nv">toolset</span><span class="o">=</span>clang
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">for this to work make sure that <code class="docutils literal"><span class="pre">clang++</span></code> is in your PATH.</p>
</div>
</div>
<div class="section" id="id1">
<h3>HDF5<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Make sure you have a compiled libz around then run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang <span class="se">\</span>
<span class="nv">CXX</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang++11 <span class="se">\</span>
./configure --enable-cxx --prefix<span class="o">=</span><span class="nv">$HOME</span>/local/ <span class="se">\</span>
    --with-pic --disable-shared --with-zlib<span class="o">=</span><span class="nv">$HOME</span>/local/

make lib
make install
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Building the tests fails, but that should be ok for now.</p>
</div>
</div>
<div class="section" id="libskylark">
<h3>libSkylark<a class="headerlink" href="#libskylark" title="Permalink to this headline">¶</a></h3>
<p>Finally we can turn to building libSkylark. First change the CMake file:</p>
<div class="highlight-diff"><div class="highlight"><pre><span class="gh">diff --git a/CMakeLists.txt b/CMakeLists.txt</span>
<span class="gh">index ef18fa7..825dbaa 100644</span>
<span class="gd">--- a/CMakeLists.txt</span>
<span class="gi">+++ b/CMakeLists.txt</span>
<span class="gu">@@ -81,11 +81,14 @@ if (&quot;${CMAKE_CXX_COMPILER_ID}&quot; STREQUAL &quot;Clang&quot;)</span>
    )

    set (COMPILER_SPEC_FLAGS
<span class="gd">-        &quot;-W -Wall -Wno-write-strings -Wno-strict-aliasing -Wno-format -Wno-deprecated -Wno-unused-variable -Wno-unused-parameter -Wno-sign-compare&quot;</span>
<span class="gi">+        &quot;-W -Wall -Wno-write-strings -Wno-strict-aliasing -Wno-format -Wno-deprecated -Wno-unused-variable -Wno-unused-parameter -Wno-sign-compare -Wno-overloaded-virtual -Wno-unsupported-friend&quot;</span>
    )

    #set (LINK_FLAGS
    #)

    set (CMAKE_LIB_LINKER_FLAGS  &quot;${CMAKE_LIB_LINKER_FLAGS} -fPIC&quot;)

<span class="gu">@@ -157,7 +160,7 @@ include_directories (${CMAKE_SOURCE_DIR})</span>
# dependent packages
# 1. Find MPI --- we are not adding any include directories here because we
# will be using the mpi compilers, which adds these libraries by default.
<span class="gd">-find_package (MPI REQUIRED)</span>
<span class="gi">+find_package (MPI)</span>
set (CMAKE_CXX_COMPILER ${MPI_COMPILER})

# 2. Find Boost with the relevant packages --- Use dynamic boost!
<span class="gu">@@ -169,6 +172,11 @@ if (BOOST_ROOT)</span>
set(Boost_NO_BOOST_CMAKE ON)
endif (BOOST_ROOT)

<span class="gi">+if (BOOST_STATIC)</span>
<span class="gi">+  set(Boost_USE_STATIC_LIBS ON)</span>
<span class="gi">+endif (BOOST_STATIC)</span>
<span class="gi">+</span>
<span class="gi">+</span>
set(BOOST_MIN_VERSION 1.53.0)
find_package (Boost REQUIRED mpi program_options serialization)
if (Boost_FOUND)
</pre></div>
</div>
<p>and compile:</p>
<div class="highlight-sh"><div class="highlight"><pre>rm CMakeCache.txt
rm -rf CMakeFiles

<span class="nb">export </span><span class="nv">BLAS_LIBRARIES</span><span class="o">=</span><span class="s2">&quot;/opt/ibmmath/lib64/libesslsmpbg.a;/opt/ibmcmp/xlf/bg/14.1/lib64/libxlfmath.a;/opt/ibmcmp/xlf/bg/14.1/lib64/libxlf90_r.a;/opt/ibmcmp/xlsmp/bg/3.1/bglib64/libxlsmp.a&quot;</span>
<span class="nb">export </span><span class="nv">LAPACK_LIBRARIES</span><span class="o">=</span><span class="s2">&quot;/opt/ibmmath/lib64/libesslsmpbg.a;/opt/ibmcmp/xlf/bg/14.1/lib64/libxlfmath.a;/opt/ibmcmp/xlf/bg/14.1/lib64/libxlf90_r.a;/opt/ibmcmp/xlsmp/bg/3.1/bglib64/libxlsmp.a;/opt/ibmcmp/xlf/bg/14.1/bglib64/libxl.a;-Wl,--allow-multiple-definition&quot;</span>

<span class="nb">export </span><span class="nv">FFTW_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/local/fftw-3.3.3/
<span class="nb">export </span><span class="nv">HDF5_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/local
<span class="nb">export </span><span class="nv">ELEMENTAL_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/local
<span class="nb">export </span><span class="nv">COMBBLAS_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/src/CombBLAS
<span class="nb">export </span><span class="nv">RANDOM123_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/local/Random123-1.08
<span class="nb">export </span><span class="nv">BOOST_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/local/boost_1_53_0

<span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang <span class="se">\</span>
<span class="nv">CXX</span><span class="o">=</span><span class="nv">$HOME</span>/bgclang/mpi/bgclang/bin/mpiclang++11 <span class="se">\</span>
cmake -DUSE_FFTW<span class="o">=</span>ON -DUSE_COMBBLAS<span class="o">=</span>ON -DBUILD_PYTHON<span class="o">=</span>OFF -DUSE_HYBRID<span class="o">=</span>ON <span class="se">\</span>
-DBOOST_STATIC<span class="o">=</span>ON ../
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you get a <code class="docutils literal"><span class="pre">undefined</span> <span class="pre">reference</span> <span class="pre">to</span> <span class="pre">vtable</span> <span class="pre">for</span> <span class="pre">std::nested_exception</span></code>
error this hints that you most likely are missing the gcc 4.7.2 toolchain
(libc++). The missing files and instructions to patch the wrapper
scripts are provided on the ANL trac page (see top).*</p>
</div>
<p>In order to be abl to compile skylark_ml apply the following patch:</p>
<div class="highlight-diff"><div class="highlight"><pre><span class="gh">diff --git a/CMakeLists.txt b/CMakeLists.txt</span>
<span class="gh">index ef18fa7..b170cde 100644</span>
<span class="gd">--- a/CMakeLists.txt</span>
<span class="gi">+++ b/CMakeLists.txt</span>
<span class="gu">@@ -5,6 +5,8 @@ set (CMAKE_DISABLE_IN_SOURCE_BUILD ON)</span>

project (SKYLARK)

<span class="gi">+ADD_DEFINITIONS(-DSKYLARK_AVOID_BOOST_PO)</span>
<span class="gi">+</span>
set (SKYLARK_VERSION_MAJOR 0)
set (SKYLARK_VERSION_MINOR 1)
</pre></div>
</div>
</div>
<div class="section" id="slurm">
<h3>SLURM<a class="headerlink" href="#slurm" title="Permalink to this headline">¶</a></h3>
<p>On Watson Q the following SLURM script can be used to run examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nv">RUN_DIR</span><span class="o">=</span><span class="nv">$HOME</span>/work/libskylark/build
<span class="nv">RUN_EXE</span><span class="o">=</span>examples/elemental

<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$SLURM_JOBID</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    sbatch --gid<span class="o">=</span><span class="sb">`</span>hostname -s<span class="sb">`</span> --time<span class="o">=</span>10:00 --nodes<span class="o">=</span><span class="m">8</span> --ntasks-per-node<span class="o">=</span><span class="m">2</span>  -O --qos<span class="o">=</span>umax-8 <span class="nv">$0</span>
<span class="k">else</span>
    srun  --chdir<span class="o">=</span><span class="nv">$RUN_DIR</span> <span class="se">\</span>
        --output<span class="o">=</span>elemental.out <span class="se">\</span>
        --error<span class="o">=</span>error.out <span class="se">\</span>
        <span class="nv">$RUN_EXE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>which outputs</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c"># cat error.out</span>

<span class="c"># cat elemental.out</span>
Default
0.558572 -0.316131 -0.0357262 0.572592 0.142264
-0.149105 0.0597079 0.228256 -0.53152 -0.0828558
-0.201294 0.499321 0.397655 0.6972 -0.303714
-0.36505 -0.120876 -0.276908 -0.461459 -0.255837
-0.154734 -0.0392899 0.202231 -0.298655 -0.262944
</pre></div>
</div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="quick_start.html">Quick Start Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="base.html">Base Layer</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright IBM Corporation 2012-2014.  All Rights Reserved.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>